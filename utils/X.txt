cat > /root/NEURO_CHK/handlers/menu_handler.py << 'EOF'
# /root/NEURO_CHK/handlers/menu_handler.py
from telegram import Update, InlineKeyboardMarkup, InlineKeyboardButton
from telegram.ext import ContextTypes
from datetime import datetime

async def main_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Show main menu with options"""
    keyboard = [
        [InlineKeyboardButton("ðŸ“Š Check NeuroSnare", callback_data="check_neuro")],
        [InlineKeyboardButton("ðŸŒ Gateways", callback_data="gateways")],
        [InlineKeyboardButton("âš¡ Advance", callback_data="advance")],
        [InlineKeyboardButton("ðŸ‘¤ Credits", callback_data="credits")]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    message_text = (
        "ðŸ”® *NeuroSnare Checker v6.3*\n\n"
        "*Main Menu*\n"
        "Select an option below:"
    )
    
    if update.callback_query:
        await update.callback_query.answer()
        await update.callback_query.edit_message_text(
            text=message_text,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    else:
        await update.message.reply_text(
            text=message_text,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )

async def button_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle button callbacks from the menu"""
    query = update.callback_query
    await query.answer()
    
    callback_data = query.data
    
    if callback_data == "check_neuro":
        keyboard = [
            [InlineKeyboardButton("ðŸ” Quick Check", callback_data="quick_check")],
            [InlineKeyboardButton("ðŸ“ˆ Detailed Analysis", callback_data="detailed_check")],
            [InlineKeyboardButton("ðŸ“Š Batch Check", callback_data="batch_check")],
            [InlineKeyboardButton("â¬…ï¸ Back to Menu", callback_data="back_to_menu")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ“Š *NeuroSnare Check*\n\n"
                 "Select check type:\n"
                 "â€¢ Quick Check - Fast verification\n"
                 "â€¢ Detailed Analysis - Full report\n"
                 "â€¢ Batch Check - Multiple IDs at once",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "gateways":
        keyboard = [
            [InlineKeyboardButton("ðŸ”— SLT", callback_data="gateway_slt")],
            [InlineKeyboardButton("ðŸ’€ CARNAGE", callback_data="gateway_carnage")],
            [InlineKeyboardButton("ðŸ’³ 0.5$ STRIPE", callback_data="gateway_stripe_0.5")],
            [InlineKeyboardButton("ðŸ’³ 2$ STRIPE", callback_data="gateway_stripe_2")],
            [InlineKeyboardButton("ðŸ’³ 10$ STRIPE", callback_data="gateway_stripe_10")],
            [InlineKeyboardButton("â¬…ï¸ Back to Menu", callback_data="back_to_menu")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸŒ *Gateways*\n\n"
                 "Available payment gateways:\n"
                 "â€¢ SLT - Sri Lanka Telecom gateway\n"
                 "â€¢ CARNAGE - Premium gateway\n"
                 "â€¢ STRIPE - Various amounts available",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "advance":
        keyboard = [
            [InlineKeyboardButton("ðŸ”§ GEN", callback_data="advance_gen")],
            [InlineKeyboardButton("ðŸ›¡ï¸ VBV", callback_data="advance_vbv")],
            [InlineKeyboardButton("ðŸ”¢ Find BIN", callback_data="advance_find_bin")],
            [InlineKeyboardButton("ðŸ“Š Stats", callback_data="advance_stats")],
            [InlineKeyboardButton("ðŸ” Security Check", callback_data="advance_security")],
            [InlineKeyboardButton("â¬…ï¸ Back to Menu", callback_data="back_to_menu")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="âš¡ *Advance Tools*\n\n"
                 "Advanced features:\n"
                 "â€¢ GEN - Generate tools\n"
                 "â€¢ VBV - Verified by Visa check\n"
                 "â€¢ Find BIN - Bank Identification Number lookup\n"
                 "â€¢ Stats - Statistical analysis\n"
                 "â€¢ Security Check - Advanced security verification",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "credits":
        user = update.effective_user
        user_id = user.id
        username = f"@{user.username}" if user.username else "No username"
        
        # Check if user is admin (you can modify this logic)
        admin_users = [7612918437]  # Add actual admin user IDs here
        user_type = "ðŸ‘‘ ADMIN" if user_id in admin_users else "ðŸ‘¤ FREE USER"
        
        # Get current date
        current_date = datetime.now().strftime("%Y-%m-%d")
        
        credits_text = (
            f"ðŸ‘¤ *User Credits*\n\n"
            f"*User ID:* `{user_id}`\n"
            f"*Username:* {username}\n"
            f"*Status:* {user_type}\n"
            f"*Date:* {current_date}\n\n"
            f"*Plan Details:*\n"
        )
        
        if user_id in admin_users:
            credits_text += (
                "âœ“ Unlimited checks\n"
                "âœ“ All gateways unlocked\n"
                "âœ“ Advance tools access\n"
                "âœ“ Priority support\n"
                "âœ“ No rate limits\n"
                "ðŸ”‘ *Admin privileges*"
            )
            keyboard = [
                [InlineKeyboardButton("ðŸ› ï¸ Admin Panel", callback_data="admin_panel")],
                [InlineKeyboardButton("â¬…ï¸ Back to Menu", callback_data="back_to_menu")]
            ]
        else:
            credits_text += (
                "âœ“ 10 checks/day\n"
                "âœ“ Basic gateways\n"
                "âœ“ Limited tools\n"
                "âœ— No admin access\n"
                "âœ— Rate limited\n\n"
                "ðŸ’Ž *Upgrade to premium for full access*"
            )
            keyboard = [
                [InlineKeyboardButton("ðŸ’Ž Upgrade", callback_data="upgrade")],
                [InlineKeyboardButton("â¬…ï¸ Back to Menu", callback_data="back_to_menu")]
            ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text=credits_text,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "back_to_menu":
        await main_menu(update, context)
    
    # Gateway handlers
    elif callback_data == "gateway_slt":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Gateways", callback_data="gateways")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ”— *SLT Gateway*\n\n"
                 "Sri Lanka Telecom Gateway\n\n"
                 "*Features:*\n"
                 "â€¢ Local payments\n"
                 "â€¢ Instant processing\n"
                 "â€¢ High success rate\n"
                 "â€¢ Low fees\n\n"
                 "*Status:* âœ… Active",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "gateway_carnage":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Gateways", callback_data="gateways")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ’€ *CARNAGE Gateway*\n\n"
                 "Premium International Gateway\n\n"
                 "*Features:*\n"
                 "â€¢ Worldwide access\n"
                 "â€¢ High limits\n"
                 "â€¢ Advanced security\n"
                 "â€¢ 24/7 support\n\n"
                 "*Status:* âœ… Active",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "gateway_stripe_0.5":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Gateways", callback_data="gateways")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ’³ *0.5$ STRIPE Gateway*\n\n"
                 "Micro-payment Gateway\n\n"
                 "*Features:*\n"
                 "â€¢ $0.50 minimum\n"
                 "â€¢ Test payments\n"
                 "â€¢ Quick verification\n"
                 "â€¢ Low risk\n\n"
                 "*Status:* âœ… Active",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "gateway_stripe_2":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Gateways", callback_data="gateways")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ’³ *2$ STRIPE Gateway*\n\n"
                 "Standard Payment Gateway\n\n"
                 "*Features:*\n"
                 "â€¢ $2.00 minimum\n"
                 "â€¢ Balance check\n"
                 "â€¢ Medium risk\n"
                 "â€¢ Good success rate\n\n"
                 "*Status:* âœ… Active",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "gateway_stripe_10":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Gateways", callback_data="gateways")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ’³ *10$ STRIPE Gateway*\n\n"
                 "Premium Payment Gateway\n\n"
                 "*Features:*\n"
                 "â€¢ $10.00 minimum\n"
                 "â€¢ High balance\n"
                 "â€¢ Low security\n"
                 "â€¢ Best success rate\n\n"
                 "*Status:* âœ… Active",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    # Advance handlers
    elif callback_data == "advance_gen":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Advance", callback_data="advance")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ”§ *GEN Tools*\n\n"
                 "Generation Tools:\n\n"
                 "â€¢ Card Generator\n"
                 "â€¢ Account Generator\n"
                 "â€¢ Proxy Generator\n"
                 "â€¢ Email Generator\n"
                 "â€¢ Identity Generator\n\n"
                 "*Status:* ðŸ”“ Available for Premium",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "advance_vbv":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Advance", callback_data="advance")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ›¡ï¸ *VBV Check*\n\n"
                 "Verified by Visa Checker\n\n"
                 "*Features:*\n"
                 "â€¢ VBV status check\n"
                 "â€¢ Security code check\n"
                 "â€¢ 3D Secure verification\n"
                 "â€¢ Bypass methods\n\n"
                 "*Status:* ðŸ”“ Available for Premium",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "advance_find_bin":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Advance", callback_data="advance")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ”¢ *Find BIN*\n\n"
                 "Bank Identification Number Lookup\n\n"
                 "*Features:*\n"
                 "â€¢ BIN database search\n"
                 "â€¢ Bank identification\n"
                 "â€¢ Country detection\n"
                 "â€¢ Card type detection\n"
                 "â€¢ Issuer information\n\n"
                 "*Status:* ðŸ”“ Available for Premium",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "advance_stats":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Advance", callback_data="advance")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ“Š *Statistics*\n\n"
                 "Bot Usage Statistics:\n\n"
                 "â€¢ Total checks: 1,234\n"
                 "â€¢ Success rate: 87%\n"
                 "â€¢ Active users: 567\n"
                 "â€¢ Today's checks: 42\n"
                 "â€¢ Premium users: 89\n\n"
                 "*Updated:* Just now",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "advance_security":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Advance", callback_data="advance")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ” *Security Check*\n\n"
                 "Advanced Security Verification\n\n"
                 "*Features:*\n"
                 "â€¢ Proxy detection\n"
                 "â€¢ VPN detection\n"
                 "â€¢ Fraud score\n"
                 "â€¢ Risk assessment\n"
                 "â€¢ IP reputation\n\n"
                 "*Status:* ðŸ”“ Available for Premium",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    # Other handlers
    elif callback_data == "admin_panel":
        keyboard = [
            [InlineKeyboardButton("ðŸ“Š Bot Stats", callback_data="admin_stats")],
            [InlineKeyboardButton("ðŸ‘¥ Users", callback_data="admin_users")],
            [InlineKeyboardButton("ðŸ”§ Settings", callback_data="admin_settings")],
            [InlineKeyboardButton("â¬…ï¸ Back to Credits", callback_data="credits")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ› ï¸ *Admin Panel*\n\n"
                 "Administrator tools:\n"
                 "â€¢ Bot Statistics\n"
                 "â€¢ User Management\n"
                 "â€¢ Bot Settings\n"
                 "â€¢ Logs & Monitoring",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif callback_data == "upgrade":
        keyboard = [[InlineKeyboardButton("â¬…ï¸ Back to Credits", callback_data="credits")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="ðŸ’Ž *Upgrade to Premium*\n\n"
                 "*Benefits:*\n"
                 "âœ“ Unlimited checks\n"
                 "âœ“ All gateways unlocked\n"
                 "âœ“ Advance tools access\n"
                 "âœ“ Priority support\n"
                 "âœ“ No rate limits\n\n"
                 "*Contact admin for upgrade*",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    else:
        # Unknown callback data - return to main menu
        await query.edit_message_text(
            text=f"âš ï¸ Unknown command\n\n"
                 f"Returning to main menu...",
            parse_mode='Markdown'
        )
        await main_menu(update, context)
EOF